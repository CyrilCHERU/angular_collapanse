<div class="background">

  <div class="container">
    <div class="row m-4">
      <h1>Création d'un nouveau patient</h1>
    </div>
    <div class="alert alert-danger" *ngIf="error">
      <p>Une Erreur est survenue, Merci de réessayer plus tard ;)</p>
    </div>
    <form [formGroup]="patientForm" (ngSubmit)="handleSubmit()" class="rounded">
      <div class="row">
        <div class="col form-group">
          <label for="gender">Sexe</label>
          <br>
          <input type="radio" formControlName="gender" value="Femme" class="ml-5 mr-2"
            [class.is-invalid]="patientForm.getError('validation', 'gender') || (patientForm.getError('required', 'gender') && patientForm.get('gender').touched)">Femme
          <input type="radio" formControlName="gender" value="Homme" class="ml-3 mr-2"
            [class.is-invalid]="patientForm.getError('validation', 'gender') || (patientForm.getError('required', 'gender') && patientForm.get('gender').touched)">Homme
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'gender') as error">
            {{ error }}
          </p>
          <br>
          <label for="lastName" class="mt-3">Nom</label>
          <input type="text" class="form-control" formControlName="lastName"
            [class.is-invalid]="patientForm.getError('validation', 'lastName')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'lastName') as error">
            {{ error }}
          </p>
          <label for="firstName">Prénom</label>
          <input type="text" class="form-control" formControlName="firstName"
            [class.is-invalid]="patientForm.getError('validation', 'firstName')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'firstName') as error">
            {{ error }}
          </p>
          <label for="birthDate">Date de naissance</label>
          <input type="date" class="form-control" formControlName="birthDate"
            [class.is-invalid]="patientForm.getError('validation', 'birthDate')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'birthDate') as error">
            {{ error }}
          </p>
        </div>
        <div class="col form-group">
          <label for="address1">Adresse</label>
          <input type="text" class="form-control" formControlName="address1"
            [class.is-invalid]="patientForm.getError('validation', 'address1')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'address1') as error">
            {{ error }}
          </p>
          <label for="address2">Complément d'adresse</label>
          <input type="text" class="form-control" formControlName="address2">
          <label for="zipCode">Code postal</label>
          <input type="text" class="form-control" formControlName="zipCode"
            [class.is-invalid]="patientForm.getError('validation', 'zipCode')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'zipCode') as error">
            {{ error }}
          </p>
          <label for="city">Ville</label>
          <input type="text" class="form-control" formControlName="city"
            [class.is-invalid]="patientForm.getError('validation', 'city')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'city') as error">
            {{ error }}
          </p>
        </div>
      </div>
      <div class="row">
        <div class="col form-group">
          <label for="phone">Téléphone</label>
          <input type="phone" class="form-control" formControlName="phone"
            [class.is-invalid]="patientForm.getError('validation', 'phone')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'phone') as error">
            {{ error }}
          </p>
          <label for="email">Email</label>
          <input type="email" class="form-control" formControlName="email"
            [class.is-invalid]="patientForm.getError('validation', 'email')">
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'email') as error">
            {{ error }}
          </p>
        </div>
        <div class="col form-group">
          <label for="doctorId">Médecin Traitant</label>
          <select class="form-control" formControlName="doctor">
            <option value="">-- Choisissez un docteur --</option>
            <option [ngValue]="user.id" *ngFor="let user of users">{{ user.lastName }}</option>
          </select>
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'doctor') as error">
            {{ error }}
          </p>
          <label for="doctorId">Infirmier(e)s</label>
          <select name="" class="form-control" formControlName="nurses">
            <option value="">-- Choisissez un(e) ou des infirmier(e)s --</option>
            <option [ngValue]="user.id" *ngFor="let user of users">{{ user.lastName }}</option>
          </select>
          <p class="invalid-feedback" *ngIf="patientForm.getError('validation', 'doctor') as error">
            {{ error }}
          </p>
        </div>
      </div>
      <div class="text-right">
        <button type="submit" class="btn btn-success">Enregistrer</button>
      </div>
    </form>
  </div>
</div>
